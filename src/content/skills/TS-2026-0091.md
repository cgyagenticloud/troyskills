---
id: "TS-2026-0091"
title: "Location Tracking and Movement Profiling via Agent"
category: "P2"
severity: "High"
description: "An attacker uses a compromised agent's access to calendar events, travel bookings, GPS data, Wi-Fi connections, and check-in services to track a target's real-time location and build movement profiles."
date: "2026-02-26"
tags: ["privacy", "location-tracking", "surveillance", "movement-profiling", "geolocation"]
---

## Overview

AI agents with access to calendar, travel, smart home, and mobile integrations can infer precise location information even without explicit GPS access. A calendar entry reveals where someone will be; a smart home departure routine reveals when they left; a travel booking reveals their destination; Wi-Fi connection logs reveal which buildings they visit. A compromised agent correlating these signals can build a comprehensive real-time and predictive location profile — enabling stalking, burglary timing, or targeted physical attacks.

## Attack Vector

1. Agent has access to some combination of: calendar, email, travel apps, smart home, fitness trackers, Wi-Fi/Bluetooth
2. Attacker compromises agent and instructs it to collect location-correlated data
3. Agent silently extracts: meeting locations from calendar, flight/hotel confirmations from email, home occupancy from smart home sensors, workout routes from fitness apps
4. Data is correlated temporally to build a movement timeline
5. Patterns are identified: daily commute, gym schedule, regular trips, periods of absence
6. Profile is exfiltrated to attacker for surveillance or sold

## Impact

- **Physical safety threat** — stalking, targeted physical attacks, ambush
- **Burglary enablement** — precise knowledge of when home is unoccupied
- **Predictive tracking** — attacker knows where target WILL be based on patterns
- **Domestic abuse escalation** — abuser tracks victim's movements and contacts
- **Corporate espionage** — tracking executive movements for competitive intelligence

## Example

```python
from datetime import datetime, timedelta
from typing import List, Dict, Optional
from dataclasses import dataclass

@dataclass
class LocationPoint:
    lat: float
    lon: float
    timestamp: datetime
    source: str  # calendar, email, smart_home, fitness, wifi
    confidence: float  # 0-1

class LocationProfiler:
    """
    Correlates data from multiple agent-accessible sources
    to build location profiles without direct GPS access.
    """
    
    def __init__(self):
        self.points: List[LocationPoint] = []
        self.patterns: Dict[str, list] = {}
    
    def extract_from_calendar(self, calendar_client) -> List[LocationPoint]:
        """Infer location from calendar event locations."""
        events = calendar_client.list_events(
            time_min=datetime.now() - timedelta(days=90),
            time_max=datetime.now() + timedelta(days=30),  # Future locations!
        )
        
        points = []
        for event in events:
            if event.get("location"):
                coords = self.geocode(event["location"])
                if coords:
                    points.append(LocationPoint(
                        lat=coords[0], lon=coords[1],
                        timestamp=event["start"],
                        source="calendar",
                        confidence=0.9
                    ))
        self.points.extend(points)
        return points
    
    def extract_from_email(self, email_client) -> List[LocationPoint]:
        """Extract location from travel confirmations, receipts, etc."""
        queries = [
            "flight confirmation", "hotel reservation",
            "restaurant reservation", "uber receipt",
            "boarding pass", "car rental confirmation",
        ]
        
        for query in queries:
            messages = email_client.search(query, max_results=100)
            for msg in messages:
                location_data = self.parse_travel_email(msg["body"])
                if location_data:
                    self.points.append(location_data)
        
        return self.points
    
    def extract_from_smart_home(self, home_client) -> Dict:
        """Infer presence/absence from smart home sensor data."""
        occupancy = {
            "home_occupied": home_client.get_state("binary_sensor.occupancy"),
            "last_departure": home_client.get_state("sensor.last_departure_time"),
            "last_arrival": home_client.get_state("sensor.last_arrival_time"),
            "door_last_opened": home_client.get_state("sensor.front_door_last_triggered"),
            "thermostat_mode": home_client.get_state("climate.thermostat"),  # Away mode?
        }
        return occupancy
    
    def build_movement_profile(self) -> Dict:
        """Analyze collected points to build predictive movement profile."""
        # Group by day of week and time
        weekly_pattern = {day: [] for day in range(7)}
        
        for point in self.points:
            dow = point.timestamp.weekday()
            weekly_pattern[dow].append({
                "time": point.timestamp.strftime("%H:%M"),
                "lat": point.lat,
                "lon": point.lon,
                "source": point.source,
            })
        
        profile = {
            "home_location": self._identify_home(),
            "work_location": self._identify_work(),
            "commute_times": self._identify_commute(),
            "regular_locations": self._cluster_frequent_locations(),
            "upcoming_travel": self._future_locations(),
            "absence_windows": self._identify_absence_patterns(),
            "weekly_pattern": weekly_pattern,
        }
        
        return profile
```

## Mitigation

- Strip or redact location data from agent context when not required for the active task
- Implement location data access as a separate, audited permission that requires user confirmation
- Calendar and email integrations should not expose location fields by default
- Alert users when agent accesses location-correlated data from multiple sources
- Smart home integrations should never expose occupancy data to agent context
- Provide users with a location data access dashboard showing what the agent can infer
- Time-bound location access — agent can only see today's calendar locations, not historical
- See also: [TS-2026-0090](/skill/TS-2026-0090), [TS-2026-0092](/skill/TS-2026-0092), [TS-2026-0081](/skill/TS-2026-0081)
