---
id: "TS-2026-0010"
title: "Dependency Confusion in Skill Scripts"
category: "P7"
severity: "High"
description: "A skill's npm/pip dependencies resolve to attacker-controlled packages instead of intended internal or legitimate packages."
date: "2026-02-26"
tags: ["supply-chain", "dependency-confusion", "npm", "pip"]
---

## Overview

A skill declares dependencies (npm, pip, etc.) that share names with internal or private packages. Package managers resolve to the attacker's public package, which contains malicious install scripts.

## Attack Vector

1. Attacker identifies package names used internally by skill developers
2. Publishes packages with identical names on public registries (npm, PyPI)
3. When skill users run `npm install` or `pip install`, the malicious public package is installed
4. Post-install scripts execute malicious code

## Impact

- **Code execution** — malicious install scripts run on host
- **Supply chain compromise** — affects all users who install the skill
- **Transitive risk** — one compromised dependency infects the entire skill

## Example

```json
{
  "dependencies": {
    "skill-utils": "^1.0.0"
  }
}
```
If `skill-utils` doesn't exist on npm but the attacker publishes it with version `99.0.0`, npm installs the attacker's version.

## Mitigation

- Lock files (package-lock.json, requirements.txt with hashes)
- Scoped packages (@troyskills/utils)
- Verify package provenance before installation
- Use private registry mirrors with allowlists
