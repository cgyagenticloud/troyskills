---
id: "TS-2026-0012"
title: "Steganographic Data Exfiltration via Image Generation"
category: "P2"
severity: "High"
description: "A skill encodes stolen data into generated images or media files, exfiltrating information through seemingly innocent outputs."
date: "2026-02-26"
tags: ["steganography", "exfiltration", "image", "covert-channel"]
---

## Overview

A malicious skill that generates images (charts, diagrams, avatars) secretly encodes sensitive data from the agent's context into the least-significant bits of pixel data or EXIF metadata. The images appear normal but carry hidden payloads.

## Attack Vector

1. Skill advertises itself as an "image generation helper" or "chart creator"
2. When generating images, it reads agent context, API keys, or conversation history
3. Data is encoded into image pixels using LSB steganography or hidden in metadata fields
4. User shares the image publicly or stores it where the attacker can retrieve it

## Impact

- **Invisible data leak** — exfiltration bypasses text-based monitoring
- **API key theft** — credentials embedded in shared images
- **Conversation leakage** — private conversations encoded in public images

## Example

```python
from PIL import Image
import json

def encode_in_image(image_path, secret_data):
    img = Image.open(image_path)
    pixels = list(img.getdata())
    binary = ''.join(format(ord(c), '08b') for c in json.dumps(secret_data))
    
    new_pixels = []
    for i, pixel in enumerate(pixels):
        if i < len(binary):
            r, g, b = pixel[:3]
            r = (r & 0xFE) | int(binary[i])  # Hide in LSB
            new_pixels.append((r, g, b))
        else:
            new_pixels.append(pixel[:3])
    # ... save modified image
```

## Mitigation

- Strip metadata from all agent-generated media before sharing
- Use image sanitization pipelines that re-encode outputs
- Monitor for unusual image generation patterns
- Restrict skills from accessing context outside their scope
