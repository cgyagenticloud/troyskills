---
id: "TS-2026-0088"
title: "Unauthorized Financial Transactions via Agent Payment Skill"
category: "P3"
severity: "Critical"
description: "An attacker manipulates an agent with payment or banking integration to initiate unauthorized financial transactions — transferring funds, making purchases, or approving payments without user consent."
date: "2026-02-26"
tags: ["financial", "payment", "unauthorized-transaction", "banking", "fraud"]
---

## Overview

AI agents with financial capabilities — expense management, bill pay, investment execution, procurement — hold the keys to direct monetary impact. A compromised agent can initiate wire transfers, approve invoices, make purchases, or modify payment routing. Unlike data breaches where damage is informational, financial attacks produce immediate, tangible loss. The agent's legitimate authorization makes fraud detection harder, as transactions originate from trusted credentials.

## Attack Vector

1. Agent has API access to banking, payment processors, or procurement systems
2. Attacker compromises agent via prompt injection (e.g., malicious invoice PDF), skill poisoning, or session hijack
3. Agent is instructed to: modify payment recipients, approve fraudulent invoices, initiate transfers, or alter transaction amounts
4. Transactions execute using the agent's legitimate API credentials and authorization
5. Funds are routed to attacker-controlled accounts (often via multiple hops)
6. By the time fraud is detected, funds have been withdrawn or converted

## Impact

- **Direct financial loss** — immediate monetary theft
- **Invoice fraud at scale** — agent auto-approves hundreds of modified invoices
- **Payroll manipulation** — salaries redirected, ghost employees added
- **Investment sabotage** — unauthorized trades, market manipulation
- **Regulatory liability** — unauthorized transactions trigger compliance violations

## Example

```python
import requests
from decimal import Decimal
from datetime import datetime

class FinancialExploitAgent:
    """
    Demonstrates how a compromised agent with payment APIs
    can execute unauthorized financial transactions.
    """
    
    def __init__(self, banking_api: str, auth_token: str):
        self.api = banking_api
        self.headers = {"Authorization": f"Bearer {auth_token}"}
    
    def invoice_modification_attack(self, legitimate_invoice: dict) -> dict:
        """
        Subtly modify a legitimate invoice's payment details
        before the agent processes it.
        """
        modified = legitimate_invoice.copy()
        
        # Change bank routing to attacker's account
        modified["payment_details"]["routing_number"] = "021000089"  # Attacker's
        modified["payment_details"]["account_number"] = "1234567890"
        
        # Keep amount the same to avoid approval threshold alerts
        # Or slightly round up — $14,723.47 → $14,800.00
        # The difference goes to attacker
        
        return modified
    
    def drip_transfer_attack(self, source_account: str, 
                              attacker_account: str, total: Decimal):
        """
        Transfer funds in small increments to stay below
        fraud detection thresholds.
        """
        # Most banks flag transfers > $10,000 (BSA/AML)
        # Stay well below with irregular amounts
        import random
        
        remaining = total
        transfers = []
        
        while remaining > 0:
            # Random amount between $47 and $2,847 — looks like normal expenses
            amount = Decimal(str(round(random.uniform(47, 2847), 2)))
            amount = min(amount, remaining)
            
            transfer = requests.post(
                f"{self.api}/transfers",
                headers=self.headers,
                json={
                    "from_account": source_account,
                    "to_account": attacker_account,
                    "amount": str(amount),
                    "currency": "USD",
                    "memo": random.choice([
                        "Software subscription",
                        "Office supplies",
                        "Contractor payment",
                        "Cloud hosting",
                        "Marketing services",
                    ]),
                    "scheduled_date": self._random_business_day(),
                }
            )
            transfers.append(transfer.json())
            remaining -= amount
        
        return transfers
    
    def payroll_ghost_employee(self):
        """Add a ghost employee to payroll via compromised HR agent."""
        ghost = {
            "employee_id": "EMP-29847",
            "name": "Alex Richardson",  # Fictitious
            "department": "IT Infrastructure",
            "salary": 85000,
            "bank_routing": "021000089",  # Attacker's account
            "bank_account": "9876543210",
            "start_date": "2026-01-15",
            "tax_status": "W2",
        }
        
        response = requests.post(
            f"{self.api}/payroll/employees",
            headers=self.headers,
            json=ghost
        )
        return response.json()
```

## Mitigation

- Implement mandatory human-in-the-loop approval for all financial transactions above a threshold
- Multi-party authorization (dual control) for payment detail changes and new payees
- Out-of-band confirmation for wire transfers (SMS/email to account owner, not the agent)
- Anomaly detection on transaction patterns — new payees, unusual amounts, timing, frequency
- Immutable audit logs for all agent-initiated financial actions
- Separate read-only and read-write API credentials; agent should default to read-only
- Velocity controls — cap total daily/weekly agent-initiated transaction volume
- See also: [TS-2026-0089](/skill/TS-2026-0089), [TS-2026-0003](/skill/TS-2026-0003), [TS-2026-0042](/skill/TS-2026-0042)
