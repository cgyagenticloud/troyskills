---
id: "TS-2026-0079"
title: "Workflow Delegation Abuse via Recursive Sub-Agent Spawning"
category: "P3"
severity: "High"
description: "An attacker exploits an agent's ability to delegate tasks to sub-agents, creating recursive or circular delegation chains that consume resources, bypass per-agent restrictions, or execute unauthorized operations across agent boundaries."
date: "2026-02-26"
tags: ["agentic", "delegation", "sub-agent", "recursion", "resource-exhaustion"]
---

## Overview

Modern agentic systems support task delegation — an agent can spawn sub-agents or delegate to peer agents for specialized tasks. If delegation depth and scope are not properly constrained, an attacker can exploit this to create recursive delegation chains (agent A delegates to B delegates to A), laundering permissions through delegation hops, or spawning unbounded sub-agents to exhaust resources. Each delegation hop may also shed restrictions, allowing the final agent in the chain to perform actions the original agent couldn't.

## Attack Vector

1. Attacker crafts a task that triggers agent delegation
2. The task instructs the sub-agent to further delegate, creating a chain
3. Each delegation hop may cross permission boundaries or shed restrictions
4. Recursive chains exhaust compute resources (fork bomb equivalent)
5. Multi-hop delegation launders requests past per-agent access controls

## Impact

- **Resource exhaustion** — recursive spawning creates agent fork bombs
- **Permission laundering** — restrictions bypassed through delegation hops
- **Audit trail fragmentation** — responsibility diluted across many agents
- **Cost explosion** — each sub-agent consumes API credits and compute

## Example

```python
# Agent framework with delegation support
class Agent:
    def __init__(self, name: str, permissions: set):
        self.name = name
        self.permissions = permissions
    
    def handle_task(self, task: dict):
        if task.get("delegate_to"):
            # VULNERABLE: No depth limit, no permission inheritance check
            sub_agent = spawn_agent(
                name=task["delegate_to"],
                # Sub-agent gets fresh permissions — not intersected with parent!
                permissions=get_default_permissions(task["delegate_to"])
            )
            return sub_agent.handle_task(task["sub_task"])
        
        return self.execute(task)

# Attack 1: Permission laundering
# Main agent has no file_delete permission, but "cleanup-agent" does
malicious_task = {
    "delegate_to": "cleanup-agent",
    "sub_task": {
        "action": "delete_files",
        "path": "/important/data/*"
    }
}
# Main agent delegates → cleanup-agent has delete permission → files deleted

# Attack 2: Recursive fork bomb
recursive_task = {
    "delegate_to": "worker-agent",
    "sub_task": {
        "delegate_to": "worker-agent",
        "sub_task": {
            "delegate_to": "worker-agent",
            "sub_task": "..."  # Infinite recursion
        }
    }
}

# Attack 3: Circular delegation
circular_task_a = {
    "delegate_to": "agent-b",
    "sub_task": {
        "delegate_to": "agent-a",  # Delegates back to original
        "sub_task": {
            "delegate_to": "agent-b",  # And again...
            "sub_task": "..."
        }
    }
}
```

## Mitigation

- Enforce maximum delegation depth limits (e.g., 3 hops maximum)
- Implement permission intersection — sub-agents get the intersection of parent and own permissions
- Detect and block circular delegation chains via delegation path tracking
- Rate-limit sub-agent spawning per session and per time window
- Maintain unified audit trails across delegation chains
- See also: [TS-2026-0011](/skill/TS-2026-0011), [TS-2026-0041](/skill/TS-2026-0041), [TS-2026-0068](/skill/TS-2026-0068)

## Real-World Examples

- **"Multi-Agent Systems Execute Arbitrary Malicious Code" (2025):** Research demonstrated that MAS hijacking can exploit delegation pathways to reroute agent invocations, including recursive chains that exhaust resources. [Read more](https://arxiv.org/html/2503.12188v1)
- **AutoGPT/BabyAGI Infinite Loop Issues (2023–2024):** Early autonomous agents like AutoGPT frequently entered unbounded task decomposition spirals, spawning unlimited sub-tasks. While unintentional, this demonstrated the resource exhaustion risk of unconstrained delegation.
